<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="date" content="2015-06-17" />

<title>animint tutorial</title>

<script src="index_files/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="index_files/bootstrap-3.3.1/css/readable.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="index_files/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="index_files/bootstrap-3.3.1/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="index_files/highlight/default.css"
      type="text/css" />
<script src="index_files/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<div class="container-fluid main-container">


<div id="header">
<h1 class="title">animint tutorial</h1>
<h4 class="date"><em>2015-06-17</em></h4>
</div>

<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#creating-sharing-embedding-animint-plots">Creating, sharing &amp; embedding animint plots</a><ul>
<li><a href="#creating-and-developing-locally">Creating and developing locally</a></li>
<li><a href="#share-animint-plots-via-bl.ocks.org">Share animint plots via bl.ocks.org</a></li>
<li><a href="#seamless-embedding-with-knitr">Seamless embedding with knitr</a></li>
<li><a href="#animint-plays-nice-with-shinyrmarkdown">animint plays nice with shiny/rmarkdown</a></li>
</ul></li>
<li><a href="#the-grammar-of-graphics">The grammar of graphics</a><ul>
<li><a href="#extending-the-grammar-to-enable-linked-selection">Extending the grammar to enable linked selection</a></li>
</ul></li>
<li><a href="#tornado-example">Tornado example</a><ul>
<li><a href="#simpler-bar-plots">Simpler bar plots</a></li>
<li><a href="#plot-themes">Plot Themes</a></li>
<li><a href="#text-that-responds-to-clickselects">Text that responds to clickSelects</a></li>
<li><a href="#animation">Animation</a></li>
<li><a href="#make_tallrect"><code>make_tallrect()</code></a></li>
</ul></li>
<li><a href="#climate-example">Climate Example</a></li>
<li><a href="#implemented-geoms">Implemented Geoms</a><ul>
<li><a href="#lines">Lines</a></li>
<li><a href="#points">Points</a></li>
<li><a href="#interactive-plots-and-scale_size">Interactive plots and <code>scale_size()</code></a></li>
<li><a href="#geom_abline"><code>geom_abline()</code></a></li>
<li><a href="#geom_ribbon"><code>geom_ribbon()</code></a></li>
<li><a href="#geom_tile"><code>geom_tile()</code></a></li>
<li><a href="#geom_path"><code>geom_path()</code></a></li>
<li><a href="#geom_polygon"><code>geom_polygon()</code></a></li>
<li><a href="#geom_linerange"><code>geom_linerange()</code></a></li>
<li><a href="#geom_histogram"><code>geom_histogram()</code></a></li>
<li><a href="#geom_violin"><code>geom_violin()</code></a></li>
<li><a href="#geom_step"><code>geom_step()</code></a></li>
<li><a href="#geom_contour"><code>geom_contour()</code></a></li>
<li><a href="#scale_y_log10-and-geom_contour-with-stat_density2d"><code>scale_y_log10()</code> and <code>geom_contour()</code> with <code>stat_density2d()</code></a></li>
<li><a href="#geom_polygon-with-stat-density2d-contours"><code>geom_polygon</code> with <code>stat = 'density2d'</code> contours</a></li>
<li><a href="#tile-plot-filled-by-density">Tile plot filled by density</a></li>
<li><a href="#density-mapped-to-point-size">Density mapped to point size</a></li>
<li><a href="#creating-maps-with-animint">Creating maps with animint</a></li>
<li><a href="#stacked-bar-chart">Stacked bar chart</a></li>
<li><a href="#geom_area-with-stat_density"><code>geom_area()</code> with <code>stat_density()</code></a></li>
<li><a href="#geom_freqpoly"><code>geom_freqpoly()</code></a></li>
<li><a href="#geom_hex"><code>geom_hex()</code></a></li>
</ul></li>
<li><a href="#session-info">Session Info</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This tutorial demonstrates <a href="https://github.com/tdhock/animint"><strong>animint</strong></a> – an <code>R</code> package for converting <a href="http://cran.r-project.org/web/packages/ggplot2/index.html"><strong>ggplot2</strong></a> plots into web-based interactive visualizations.</p>
</div>
<div id="creating-sharing-embedding-animint-plots" class="section level2">
<h2>Creating, sharing &amp; embedding animint plots</h2>
<p>Suppose we have a basic <strong>ggplot2</strong> plot:</p>
<pre class="r"><code>library(&quot;ggplot2&quot;)
data(tips, package = &quot;reshape2&quot;)
tips$sex_smoker &lt;- with(tips, interaction(sex, smoker))
p &lt;- ggplot() +
  geom_point(data = tips, 
             aes(x = total_bill, y = tip, colour = sex_smoker))
p</code></pre>
<p><img src="index_files/figure-html/density-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<div id="creating-and-developing-locally" class="section level3">
<h3>Creating and developing locally</h3>
<p>The <code>animint2dir()</code> function is most useful for local development and quickly iterating your <strong>animint</strong> plots. This function compiles a list of ggplot objects (and a <a href="https://github.com/tdhock/animint/wiki/Advanced-features-present-animint-but-not-in-ggplot2">list of other options</a>), <a href="https://github.com/tdhock/animint/wiki/Compiler-details">compiles them</a>, and write a set of files to a directory. Here we write those files to the “simple” directory.</p>
<pre class="r"><code>library(&quot;animint&quot;)
animint2dir(list(plot = p), out.dir = &quot;simple&quot;, open.browser = FALSE)</code></pre>
<p>To view the result, you’ll probably want to start a local <a href="http://en.wikipedia.org/wiki/File_server">file server</a> in the “simple” directory. This can be done easily from the <code>R</code> console with the <a href="http://cran.r-project.org/web/packages/servr/index.html"><strong>servr</strong></a> package:</p>
<pre class="r"><code>servr::httd(&quot;simple&quot;) # press ESC to stop the server &amp; resume R session</code></pre>
</div>
<div id="share-animint-plots-via-bl.ocks.org" class="section level3">
<h3>Share animint plots via bl.ocks.org</h3>
<p>If you want to quickly share your plot with others and have a <a href="https://github.com/">GitHub</a> account, <code>animint2gist()</code> will compile your ggplot’s and upload the resulting files as a <a href="https://gist.github.com/">gist</a> which can then be viewed via <a href="http://bl.ocks.org/">http://bl.ocks.org/</a></p>
<pre class="r"><code>animint2gist(list(plot = p))</code></pre>
</div>
<div id="seamless-embedding-with-knitr" class="section level3">
<h3>Seamless embedding with knitr</h3>
<p>You can simply add a class of “animint” to a list ggplot objects and <strong>knitr</strong> will know to call <code>animint2dir()</code> to embed the animint plots in the document.</p>
<pre class="r"><code>structure(list(plot = p), class = &quot;animint&quot;)</code></pre>
<script type="text/javascript" src="simple/vendor/d3.v3.js"></script>
<script type="text/javascript" src="simple/animint.js"></script><p></p>
<div id="simple">

</div>
<script>var plot = new animint("#simple", "simple/plot.json");</script>

<p>Required files will be written to a directory determined by the chunk label. For this reason, you’ll want to specify <code>selfcontained: false</code> when using <a href="http://rmarkdown.rstudio.com/"><strong>rmarkdown</strong></a>.</p>
</div>
<div id="animint-plays-nice-with-shinyrmarkdown" class="section level3">
<h3>animint plays nice with shiny/rmarkdown</h3>
<p><a href="https://cpsievert.shinyapps.io/animintShiny">See here</a> to see how to embed animint plots in <a href="http://cran.r-project.org/web/packages/shiny/index.html"><strong>shiny</strong></a> and <a href="https://cpsievert.shinyapps.io/animintRmarkdown">here</a> to embed <strong>animint</strong> plots in <a href="http://rmarkdown.rstudio.com/authoring_shiny.html">interactive documents</a>.</p>
</div>
</div>
<div id="the-grammar-of-graphics" class="section level2">
<h2>The grammar of graphics</h2>
<p><strong>ggplot2</strong> is an implementation of the <a href="http://www.amazon.com/The-Grammar-Graphics-Statistics-Computing/dp/0387245448">grammar of graphics</a> which adds the ability to create <a href="http://vita.had.co.nz/papers/layered-grammar.html">layered graphics</a>. A layer consists of five components: Data, Aesthetics, Statistics, Geometry, and Positional Adjustment. The figure below shows how the components fit together to make up a layer. To keep the illustration simple, the graphic in this example is composed of just one layer, but <strong>ggplot2</strong> (and <strong>animint</strong>) allows for multiple layers on a single plot.</p>
<div align="center">
<img src="gg.png" width = "700px" height = "300px">
</div>
<div id="extending-the-grammar-to-enable-linked-selection" class="section level3">
<h3>Extending the grammar to enable linked selection</h3>
<p><strong>animint</strong> understands two aesthetics in addition to the usual ggplot2 aesthetics: <code>clickSelects</code> and <code>showSelected</code>:</p>
<div align="center">
<img src="clickSelects.png" width = "700px" height = "300px"> <img src="showSelected.png" width = "700px" height = "300px">
</div>
<p>In general, <code>clickSelects</code>/<code>showSelected</code> specifies a link between <span class="math">\(m\)</span> and <span class="math">\(n\)</span> observations. This allows animint to show/hide subsets of data (<code>showSelected</code>) according to the current selection(s) (<code>clickSelects</code>). Statistically speaking, this yields sets of visualizations of <em>conditional</em> distributions – where the conditioning variable is <em>categorical</em>. If you want to condition on a <em>quantitative</em> variable, you can discretize beforehand. For a simple example, let’s continue with the <code>tips</code> data:</p>
<pre class="r"><code>p1 &lt;- ggplot() + theme(legend.position = &quot;none&quot;) +
  geom_point(data = tips, 
             aes(x = sex, y = smoker, 
                 clickSelects = sex_smoker, colour = sex_smoker),
             position = &quot;jitter&quot;)
p2 &lt;- ggplot() +
  geom_point(data = tips, 
             aes(x = total_bill, y = tip, 
                 showSelected = sex_smoker, colour = sex_smoker))</code></pre>
<pre class="r"><code>plots &lt;- list(plot1 = p1, plot2 = p2)
structure(plots, class = &quot;animint&quot;)</code></pre>
<p></p>
<div id="unnamedchunk5">

</div>
<script>var plot = new animint("#unnamedchunk5", "unnamedchunk5/plot.json");</script>

<p>On the left hand panel, we can click the different colours to change the current selection and view the differences in the relationship between bill amount and tips. Notice how bill amount and tip have lower correlation amongst smokers (especially male smokers). The next section shows how we can leverage <code>clickSelects</code>, <code>showSelected</code>, and <a href="https://github.com/tdhock/animint/wiki/Advanced-features-present-animint-but-not-in-ggplot2">other animint options</a> to make more complex interactive animations.</p>
</div>
</div>
<div id="tornado-example" class="section level2">
<h2>Tornado example</h2>
<p>Animint includes a dataset from the US National Oceanic and Atmospheric Administration, listing all recorded tornadoes in the US from 1950 - 2006 with GIS information. The data can be found <a href="http://www.spc.noaa.gov/wcm/#data">here</a> or loaded into R using the command <code>data(UStornadoes, package = &quot;animint&quot;)</code>.</p>
<pre class="r"><code>library(&quot;plyr&quot;)
library(&quot;maps&quot;)
data(UStornadoes, package = &quot;animint&quot;)

USpolygons &lt;- map_data(&quot;state&quot;)
USpolygons$state = state.abb[match(USpolygons$region, tolower(state.name))]

map &lt;- ggplot() + 
  geom_polygon(aes(x = long, y = lat, group = group), 
               data = USpolygons, fill = &quot;black&quot;, colour = &quot;grey&quot;) +
  geom_segment(aes(x = startLong, y = startLat, xend = endLong, yend = endLat, showSelected = year), 
               colour = &quot;#55B1F7&quot;, data = UStornadoes) +
  ggtitle(&quot;Tornadoes in the US&quot;)

ts &lt;- ggplot() + 
  stat_summary(aes(year, year, clickSelects = year), 
               data = UStornadoes, fun.y = length, geom = &quot;bar&quot;) + 
  ggtitle(&quot;Number of Recorded Tornadoes, 1950-2006&quot;) + 
  ylab(&quot;Number of Tornadoes&quot;) + 
  xlab(&quot;Year&quot;)

# specify map width to be 970px
# theme_animint() requires Toby&#39;s fork of ggplot2
# devtools::install_github(&quot;tdhock/ggplot2&quot;)
# (we&#39;re hopeful this fork will be merged with ggplot2 master)
map &lt;- map + theme_animint(width = 970)

tornado.bar &lt;- list(map = map, ts = ts) 

animint2dir(tornado.bar, &quot;tornado-bar&quot;)</code></pre>
<p>The <a href="tornado-bar/index.html">resulting plot</a> is better viewed in another tab/window.</p>
<p>Clicking on a specific bar causes the subset of data corresponding to that year to be “selected” and plotted on the US map. We specified this by including <code>showSelected=year</code> in the <code>aes()</code> statement for map, and <code>clickSelects=year</code> in the <code>aes()</code> statement for <code>ts</code>. The graph dynamically updates based on the user’s clicks.</p>
<p>The syntax for this example is slightly tricky, because the standard specification of <code>geom_bar(aes(x=year, clickSelects=year), data=UStornadoes, stat=&quot;bin&quot;)</code> does not work with <strong>animint</strong> at this time. This is because <code>clickSelects</code> is not a <strong>ggplot2</strong> aesthetic, and so the binning algorithm does not behave properly when <code>clickSelects</code> is specified. Using <code>stat_summary()</code> allows us to avoid this behavior.</p>
<div id="simpler-bar-plots" class="section level3">
<h3>Simpler bar plots</h3>
<p>In order to make bar plots with <code>stat_bin()</code> somewhat easier, <strong>animint</strong> includes a <code>make_bar()</code> function, which helps facilitate bar charts with <code>clickSelects</code> aesthetics.</p>
<pre class="r"><code>ts &lt;- ggplot() + make_bar(UStornadoes, &quot;year&quot;) + 
  ggtitle(&quot;Number of Recorded Tornadoes, 1950-2006&quot;) + 
  ylab(&quot;Number of Tornadoes&quot;) + 
  xlab(&quot;Year&quot;)

tornado.bar &lt;- list(map = map, ts = ts, width=list(map = 970, ts = 500),  height=list(500)) 

animint2dir(tornado.bar, &quot;tornado-bar2&quot;)</code></pre>
<p>This code produces the <a href="tornado-bar2/index.html">same plot</a>, but with a much more intuitive syntax.</p>
</div>
<div id="plot-themes" class="section level3">
<h3>Plot Themes</h3>
<p>We typically do not want plot axes and labels displayed on a map, because it’s obvious what the x and y axes are. While animint does not support all of <strong>ggplot2</strong>’s <code>theme()</code> options, it does support removing the axes, labels, and axis titles.</p>
<p>To fully remove all evidence of the axes, we must separately remove axis lines, ticks, text (axis break labels), and titles.</p>
<pre class="r"><code>map &lt;- ggplot() + 
  geom_polygon(aes(x = long, y = lat, group = group), 
               data = USpolygons, fill = &quot;black&quot;, colour = &quot;grey&quot;) +
  geom_segment(aes(x = startLong, y = startLat, xend = endLong, yend = endLat, showSelected = year), 
               colour = &quot;#55B1F7&quot;, data = UStornadoes) +
  ggtitle(&quot;Tornadoes in the US&quot;) + 
  theme(axis.line = element_blank(), axis.text = element_blank(), 
        axis.ticks = element_blank(), axis.title = element_blank()) +
  theme_animint(width = 970)

tornado.bar &lt;- list(map = map, ts = ts) 
animint2dir(tornado.bar, &quot;tornado-bar3&quot;)</code></pre>
<p>You can see the resulting plot <a href="tornado-bar3/index.html">here</a>. Notice that the axes have been removed from the map, leaving only the data displayed on that plot.</p>
<p>We may want to allow users to select a state as well as a year, so that the bar chart shows the number of tornadoes over time for a specific state, and the map shows the tornadoes that occurred during the selected year. To do this, we will need to create a summarized dataset. We’ll create a data frame that contains the number of tornadoes occurring in each state for each year in the dataset.</p>
<pre class="r"><code>UStornadoCounts &lt;-
  ddply(UStornadoes, .(state, year), summarize, count=length(state))</code></pre>
</div>
<div id="text-that-responds-to-clickselects" class="section level3">
<h3>Text that responds to clickSelects</h3>
<p>The <code>make_text()</code> function included in <strong>animint</strong> makes it easy to create text describing what has been selected. In this case, we would like to display the year on the US map, and we would like to show the state on the bar chart. This interactivity does not work with <code>ggtitle()</code> at this time, but we can create a “title” element on the plot itself instead using make_text.</p>
<p>Syntax is <code>make_text(data, x, y, label.var, format=NULL)</code> where <code>format</code> can be specified using a string containing <code>%d</code>, <code>%f</code>, etc. to represent the variable value.</p>
<pre class="r"><code>map &lt;- ggplot() + 
  make_text(UStornadoCounts, -100, 50, &quot;year&quot;, &quot;Tornadoes in %d&quot;) +
  geom_polygon(aes(x = long, y = lat, group = group, clickSelects = state),
               data = USpolygons, fill = &quot;black&quot;, colour = &quot;grey&quot;) +
  geom_segment(aes(x = startLong, y = startLat, xend = endLong, yend = endLat,
                   showSelected = year),
               colour = &quot;#55B1F7&quot;, data = UStornadoes) + 
  theme(axis.line = element_blank(), axis.text = element_blank(), 
        axis.ticks = element_blank(), axis.title = element_blank()) +
  theme_animint(width = 970)

ts &lt;- ggplot() + 
  make_text(UStornadoes, 1980, 200, &quot;state&quot;) +
  geom_bar(aes(year, count, clickSelects = year, showSelected = state),
           data = UStornadoCounts, stat = &quot;identity&quot;, position = &quot;identity&quot;) + 
  ylab(&quot;Number of Tornadoes&quot;) + 
  xlab(&quot;Year&quot;)

tornado.ts.bar &lt;- list(map = map, ts = ts) 
animint2dir(tornado.ts.bar, &quot;tornado-ts-bar&quot;)</code></pre>
<p><a href="tornado-ts-bar/index.html">Here</a> is the resulting plot.</p>
</div>
<div id="animation" class="section level3">
<h3>Animation</h3>
<p>Animint also allows you to automatically change the selection or data shown so that the plot is animated. An element named <code>time</code> in the list provided to <code>animint2dir()</code> allows you to set the following arguments:</p>
<ul>
<li>the <strong>variable</strong> that will advance over time</li>
<li><strong>ms</strong>, the length of time in milliseconds between transitions</li>
<li><strong>duration</strong>, the time used to switch between values (in milliseconds).</li>
</ul>
</div>
<div id="make_tallrect" class="section level3">
<h3><code>make_tallrect()</code></h3>
<p>This example also demonstrates the <code>make_tallrect()</code> function, which populates a graph with bars spanning the entire y range located at each value of the variable passed in, with clickSelects element to match. Syntax is<br /><code>make_tallrect(data, x.name, alpha=1/2)</code></p>
<pre class="r"><code>map &lt;- ggplot()+
  geom_polygon(aes(x = long, y = lat, group = group, clickSelects = state),
               data = USpolygons, fill = &quot;black&quot;, colour = &quot;grey&quot;) +
  geom_segment(aes(x = startLong, y = startLat, xend = endLong, yend = endLat,
                   showSelected = year),
               colour = &quot;#55B1F7&quot;, data = UStornadoes) + 
  make_text(UStornadoCounts, -100, 50, &quot;year&quot;, &quot;Tornadoes in %d&quot;) +
  theme(axis.line = element_blank(), axis.text = element_blank(), 
        axis.ticks = element_blank(), axis.title = element_blank()) +
  theme_animint(width = 970)

ts &lt;- ggplot()+
  make_tallrect(UStornadoCounts, &quot;year&quot;)+
  make_text(UStornadoes, 1980, 200, &quot;state&quot;) +
  geom_line(aes(year, count, clickSelects = state, group = state),
            data = UStornadoCounts, alpha = 3/5, size = 4) + 
  ylab(&quot;Number of Tornadoes&quot;) + 
  xlab(&quot;Year&quot;)



tornado.anim &lt;- list(map = map, ts = ts)

# append the time object in as another object in the main list.
tornado.anim$time &lt;- list(variable = &quot;year&quot;, ms = 2000) 
 

animint2dir(tornado.anim, &quot;tornado-anim&quot;)</code></pre>
<p><a href="tornado-anim/index.html">Here</a> is the resulting plot with animation.</p>
</div>
</div>
<div id="climate-example" class="section level2">
<h2>Climate Example</h2>
<p>Dataset: 2006 Data Expo data, from NASA Goddard Institute for Space Studies. Data is a subset of the monthly climatology of the International Satellite Cloud Climatology Project (ISCCP). Dataset contains monthly observations of atmospheric variables 1995-2000, for a 24x24 grid of locations over North, South, and Central America between 113.75ºW-56.25ºW, 21.25ºS-36.25ºN with 2.5º grid spacing. Dataset contains information such as cloud cover at low, med, and high altitudes, temperature, surface temperature, pressure, and ozone concentration. Temperatures given are in Celsius.</p>
<p>Dataset description adapted from <a href="http://had.co.nz/dataexpo/isu-dataexpo.pdf">one of the submitted posters</a></p>
<pre class="r"><code>library(&quot;animint&quot;)
library(&quot;maps&quot;)
library(&quot;lubridate&quot;)
library(&quot;plyr&quot;)

data(climate, package = &quot;animint&quot;)
climate$time2 &lt;- decimal_date(ymd(as.character(climate$date)))

countries &lt;- map_data(&quot;world&quot;)
# Map coordinate limits chosen so that the polygons displayed are at least reasonably complete. 
countries &lt;- subset(countries, (lat &lt; 38) &amp; (lat &gt; -24))
countries &lt;- subset(countries, ((-long) &gt; 54) &amp; ((-long) &lt; 118))

# Create variable showing temp-avg.monthly.temp at that location
climate &lt;- ddply(climate, .(id, month), transform, 
                 tempdev = temperature - mean(temperature), 
                 surfdev = surftemp - mean(surftemp))
climate &lt;- climate[order(climate$date, climate$id), ]

# data frame with formatted labels
dates &lt;- ddply(climate, .(date), summarise, month = month[1], 
               year = year[1], time2 = time2[1], 
               textdate = paste(month.name[month], year))
dates &lt;- dates[order(dates$date),]</code></pre>
<p>As data consists of both time-sequence and spatial data, we might want to link some sort of time-series plot to maps displaying the spatial data. We might also want to be able to click on a portion of the map and see the relevant time series. This suggests that we will need at least two selectors: <code>id</code>, which identifies the spatial location, and <code>time2</code>, which is a continuous numerical representation of the time sequence, starting at 1995.000.</p>
<pre class="r"><code>tempseq &lt;- ggplot() + 
  make_tallrect(data = climate, &quot;time2&quot;) + 
  geom_line(data = climate, aes(x = time2, y = temperature, group = id, showSelected = id)) +
  geom_text(data = dates, aes(x = 1998, y = -5, label = textdate, showSelected = time2))</code></pre>
<p>This code chunk defines a plot that shows the temperature over time for a selected spatial location, and contains many <code>tallrect()</code>’s (rectangles spanning the y range that break up the x axis) that select a specific point in time. If we view this plot in R, <code>showSelected</code> is not a recognized aesthetic, and so ggplot displays all of the lines at once, and all of the tallrects are also displayed in the background. It’s a pretty messy plot!</p>
<pre class="r"><code>tempseq</code></pre>
<p><img src="index_files/figure-html/timeseries-display-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<p>In order to be able to select an ID, we must have at least one other plot in our animint plot list. Let’s start with a plot that shows how each location compares to its average monthly temperature. Note that this quantity was computed in the code chunk at the beginning of this section.</p>
<pre class="r"><code># we will re-use this set of elements, so let&#39;s define a function to add them to a plot p with tiles.
# we can&#39;t define the base plot first because the path must be drawn on top of the tiles.
plainmap &lt;- function(p){
  p + geom_path(data = countries, aes(x = long, y = lat, group = group)) + 
  geom_text(data = dates, 
            aes(x = -86, y = 39, label = textdate, showSelected = time2))+ 
  theme(axis.line = element_blank(), axis.text = element_blank(), 
        axis.ticks = element_blank(), axis.title = element_blank())
}

# tiles with temperature data to serve as the background for the plot.
temptiles &lt;- ggplot() + 
  geom_tile(data = climate, 
            aes(x = long, y = lat, fill = tempdev, 
                clickSelects = id, showSelected = time2)) + 
  scale_fill_gradient2(&quot;deg. C&quot;, low = &quot;blue&quot;, mid = &quot;white&quot;, 
                       high = &quot;red&quot;, limits = c(-20, 20), 
                       midpoint = 0) + 
  ggtitle(&quot;Temperature Deviation from Monthly Norm&quot;)

airtemp &lt;- plainmap(temptiles)</code></pre>
<p>The <code>theme()</code> statement removes the axis, axis labels, and axis title from the plot, since maps are fairly self-explanatory and longitude and latitude values don’t provide much additional information. The <code>geom_text()</code> statement is used where one would typically use a <code>make_text()</code> statement, but in this case, we want a format that is not easily derived from the <code>showSelected</code> variable.</p>
<p>Now that we have both plot types that we need for the selectors we’ve chosen, we can add animation and output to animint:</p>
<pre class="r"><code>animint2dir(list(timeseriestemp = tempseq, 
                airtemp = airtemp,
                time = list(variable = &quot;time2&quot;, ms = 3000),
                selector.types = list(id = &quot;multiple&quot;),
                width = list(450),
                height = list(450)
                ), out.dir = &quot;climate/onemap&quot;)</code></pre>
<p>The <code>time</code> variable defines which selector will change sequentially, in this case, <code>time2</code>. In addition, the plot will change every 3000 milliseconds, or every 3 seconds. We will cover the entire time period in 216 seconds, or about 3.5 minutes.</p>
<p>Here is the <a href="climate/onemap/index.html">animint-generated webpage</a>. Click on the islands off the coast of South America, and see if you can determine in what year El Nino (warming of the Pacific Ocean off the coast of South America) occurred. How much of the plot seems to be effected by this event?</p>
<p>We can also add additional maps. The dataset contains ozone data, surface temperature data, and cloud cover data.</p>
<pre class="r"><code>surftemp &lt;- plainmap(p = ggplot() + 
  geom_tile(data = climate, 
            aes(x = long, y = lat, fill = surftemp, 
                clickSelects = id, showSelected = time2)) + 
  scale_fill_gradient2(&quot;deg. C&quot;, low = &quot;blue&quot;, mid = &quot;white&quot;, 
                       high = &quot;red&quot;, limits = c(-10, 45), 
                       midpoint = 0) + 
  ggtitle(&quot;Surface Temperature&quot;))

ozone &lt;- plainmap(p = ggplot() + 
  geom_tile(data = climate, 
            aes(x = long, y = lat, fill = ozone, 
                clickSelects = id, showSelected = time2))+ 
  scale_fill_gradient(&quot;Concentration&quot;, low = &quot;white&quot;, high = &quot;brown&quot;) + 
  ggtitle(&quot;Ozone Concentration&quot;))

cloudshigh &lt;- plainmap(p = ggplot() + 
  geom_tile(data = climate, 
            aes(x = long, y = lat, fill = cloudhigh, 
                clickSelects = id, showSelected = time2)) + 
  scale_fill_gradient(&quot;Coverage&quot;, low = &quot;skyblue&quot;, high = &quot;white&quot;, 
                      limits = c(0, 75)) + 
  ggtitle(&quot;High Altitute Cloud Cover&quot;))

cloudsmid &lt;- plainmap(p = ggplot() + 
  geom_tile(data = climate, colour = &quot;grey&quot;,
            aes(x = long, y = lat, fill = cloudmid, 
                clickSelects = id, showSelected = time2))+ 
  scale_fill_gradient(&quot;Coverage&quot;, low = &quot;skyblue&quot;, high = &quot;white&quot;, 
                      limits = c(0, 75)) + 
  ggtitle(&quot;Mid Altitute Cloud Cover&quot;))

cloudslow &lt;- plainmap(p = ggplot() + 
  geom_tile(data = climate, colour = &quot;grey&quot;,
            aes(x = long, y = lat, fill = cloudlow, 
                clickSelects = id, showSelected = time2)) +
  scale_fill_gradient(&quot;Coverage&quot;, low = &quot;skyblue&quot;, high = &quot;white&quot;, 
                      limits = c(0, 75)) + 
  ggtitle(&quot;Low Altitute Cloud Cover&quot;))

animint2dir(list(timeseriestemp = tempseq,
                airtemp = airtemp,
                surftemp = surftemp,
                cloudslow = cloudslow, 
                cloudsmid = cloudsmid, 
                cloudshigh = cloudshigh, 
                ozone = ozone,
                time = list(variable=&quot;time2&quot;, ms=3000),
                selector.types = list(id = &quot;multiple&quot;),
                width = list(timeseriestemp=900, 
                             airtemp=450, surftemp=450, ozone=450, 
                             cloudslow=450, cloudsmid=450, cloudshigh=450),
                height = list(450)
                ), out.dir = &quot;climate/lotsofmaps&quot;)</code></pre>
<p>Here is the <a href="climate/lotsofmaps/index.html">animint-generated webpage</a>. This page may a while to load due to the large amount of elements the browser must render.</p>
</div>
<div id="implemented-geoms" class="section level2">
<h2>Implemented Geoms</h2>
<p>Most, but not all <strong>ggplot2</strong> geoms are implemented in <strong>animint</strong>.</p>
<div id="lines" class="section level3">
<h3>Lines</h3>
<div id="simple-lines" class="section level4">
<h4>Simple lines</h4>
<p>This should work exactly as in ggplot2.</p>
<pre class="r"><code>dat &lt;- data.frame(x = rep(1:10, times = 5), group = rep(1:5, each = 10))
dat$lt &lt;- c(&quot;even&quot;, &quot;odd&quot;)[(dat$group %% 2+1)] # linetype
dat$group &lt;- as.factor(dat$group)
dat$y &lt;- rnorm(length(dat$x), dat$x, .5) + rep(rnorm(5, 0, 2), each = 10)

#&#39; Simple line plot
p1 &lt;- ggplot() + 
  geom_line(data = dat, 
            aes(x = x, y = y, group = group)) + 
  ggtitle(&quot;geom_line&quot;)
#&#39; Simple line plot with colours...
p2 &lt;- ggplot() + 
  geom_line(data = dat, 
            aes(x = x, y = y, colour = group, group = group)) +
  ggtitle(&quot;geom_line + scale_colour_discrete&quot;)

lines_simple &lt;- list(p1 = p1, p2 = p2)
lines_simple</code></pre>
<pre><code>## $p1</code></pre>
<pre><code>## 
## $p2</code></pre>
<pre class="r"><code>animint2dir(lines_simple, &quot;geoms/line-simple&quot;)</code></pre>
<p><img src="index_files/figure-html/line-simple-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /><img src="index_files/figure-html/line-simple-2.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<p><a href="geoms/line-simple">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="linetypes" class="section level4">
<h4>Linetypes</h4>
<p><strong>ggplot2</strong> has several methods of linetype specification, all of which are supported in <strong>animint</strong>.</p>
<pre class="r"><code>#&#39; Simple line plot with colours and linetype
p3 &lt;- ggplot() + 
  geom_line(data = dat, 
            aes(x = x, y = y, colour = group, group = group, linetype = lt)) +
  ggtitle(&quot;geom_line + scale_linetype_manual&quot;)
p3</code></pre>
<p><img src="index_files/figure-html/line-types-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#&#39; Use automatic linetypes from ggplot with coerced factors
p4 &lt;- ggplot() + 
  geom_line(data = dat, 
            aes(x = x, y = y, colour = group, group = group, linetype = group)) +
  ggtitle(&quot;geom_line + scale_linetype automatic&quot;)
p4</code></pre>
<p><img src="index_files/figure-html/line-types-2.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#&#39; Manually specify linetypes using &lt;length, space, length, space...&gt; notation
dat$lt &lt;- rep(c(&quot;2423&quot;, &quot;2415&quot;, &quot;331323&quot;, &quot;F2F4&quot;, &quot;solid&quot;), each = 10)
p5 &lt;- ggplot() + 
  geom_line(data = dat, 
            aes(x = x, y = y, colour = group, group = group, linetype = lt)) + 
  scale_linetype_identity(&quot;group&quot;, guide = &quot;legend&quot;, 
                          labels = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;)) + 
  scale_colour_discrete(&quot;group&quot;) + 
  ggtitle(&quot;Manual Linetypes: dash-space length&quot;)
p5</code></pre>
<p><img src="index_files/figure-html/line-types-3.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#&#39; All possible linetypes
lts &lt;- scales::linetype_pal()(13)
lt1 &lt;- data.frame(x = 0, xend = .25, y = 1:13, yend = 1:13, 
                  lt = lts, lx = -.125)
p6 &lt;- ggplot() + 
  geom_segment(data = lt1, 
               aes(x = x, xend = xend, y = y, yend = yend, linetype = lt)) + 
  scale_linetype_identity() + 
  geom_text(data = lt1, aes(x = lx, y = y, label = lt), hjust = 0) + 
  ggtitle(&quot;Scales package: all linetypes&quot;)

lts2 &lt;- c(&quot;solid&quot;, &quot;dashed&quot;, &quot;dotted&quot;, &quot;dotdash&quot;, &quot;longdash&quot;, &quot;twodash&quot;)
lt2 &lt;- data.frame(x = 0, xend = .25, y = 1:6, yend = 1:6, lt = lts2, lx = -.125)
p7 &lt;- ggplot() + 
  geom_segment(data = lt2, 
               aes(x = x, xend = xend, y = y, yend = yend, linetype = lt)) + 
  scale_linetype_identity() + 
  geom_text(data = lt2, aes(x = lx, y = y, label = lt), hjust = 0) +
  ggtitle(&quot;Named linetypes&quot;)

line_types &lt;- list(p3 = p3, p4 = p4, p5 = p5, p6 = p6, p7 = p7)
animint2dir(line_types, &quot;geoms/line-types&quot;)</code></pre>
<p><a href="geoms/line-types">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="alpha-scales-and-lines" class="section level4">
<h4>Alpha scales and lines</h4>
<pre class="r"><code>#&#39; Spaghetti Plot Data
n &lt;- 500
pts &lt;- 10
data2 &lt;- data.frame(x = rep(1:pts, times = n), group = rep(1:n, each=pts))
data2$group &lt;- as.factor(data2$group)
data2$y &lt;- rnorm(length(data2$x), data2$x*rep(rnorm(n, 1, .25), each = pts), .25) + rep(rnorm(n, 0, 1), each = pts)
data2$lty &lt;- &quot;solid&quot;
data2$lty[which(data2$group %in% subset(data2, x == 10)$group[order(subset(data2, x == 10)$y)][1:floor(n/10)])] &lt;- &quot;3133&quot;
data2 &lt;- ddply(data2, .(group), transform, maxy = max(y), miny = min(y))
data2$below0 &lt;- factor(sign(data2$miny) &lt; 0)
  
qplot(data = data2, x = x, y = y, group = group, geom = &quot;line&quot;, alpha = I(.2))</code></pre>
<p><img src="index_files/figure-html/alphalines-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#&#39; scale_alpha
p8 &lt;- ggplot() + 
  geom_line(data = data2, alpha = .1,
            aes(x = x, y = y, group = group)) +
  ggtitle(&quot;Constant alpha&quot;)

p9 &lt;- ggplot() + 
  geom_line(data = subset(data2, as.numeric(group) &lt; 50), 
            aes(x = x, y = y, group = group, linetype = lty), 
            alpha = .2) +
  scale_linetype_identity() + 
  ggtitle(&quot;Constant alpha, I(linetype)&quot;)

p10 &lt;- ggplot() + 
  geom_line(data = subset(data2, as.numeric(group) &lt; 50), 
            aes(x = x, y = y, group = group, linetype = below0, alpha = maxy)) + 
  scale_alpha_continuous(range = c(.1, .5)) + 
  ggtitle(&quot;Continuous alpha&quot;)

#&#39; Size Scaling
p11 &lt;- ggplot() + 
  geom_line(data = subset(data2, as.numeric(group) %% 50 == 1), 
            aes(x = x, y = y, group = group, size = (floor(miny) + 3)/3)) + 
  scale_size_continuous(&quot;Line Size&quot;, range = c(1,3)) +
  ggtitle(&quot;Continuous size&quot;)

p12 &lt;- ggplot() + 
  geom_line(data = data2, 
            aes(x = x, y = y, group = group, alpha = miny, colour = maxy)) + 
  scale_alpha_continuous(range = c(.1, .3)) + 
  ggtitle(&quot;Continuous Alpha and Colour&quot;)

alphas &lt;- list(p8 = p8, p9 = p9, p10 = p10, p11 = p11, p12 = p12)
animint2dir(alphas, &quot;geoms/alphalines&quot;)</code></pre>
<p><a href="geoms/alphalines">Click here</a> to see the resulting animint plot(s).</p>
</div>
</div>
<div id="points" class="section level3">
<h3>Points</h3>
<p>In general, points are exactly the same in <strong>animint</strong> and <strong>ggplot2</strong>, with two exceptions: * Shapes are not supported in animint at this time, because d3 only provides about 6 shapes total, and it is thus not possible to map shapes from R to d3 faithfully. * In <code>R</code>, most shapes do not have separate colour and fill attributes. In d3, points have both colour and fill attributes, so it is possible to get at least 2 shapes with animint: filled and open circles. * If you specify colour but not fill, <strong>animint</strong> will attempt to set fill for you. If you want open circles, use fill=NA. * Specifying colour and fill will work in <strong>animint</strong>, but may not show up on the <strong>ggplot2</strong> plot, as ggplot2 does not typically use the fill aesthetic for points.</p>
<div id="scale_colour-and-geom_point" class="section level4">
<h4><code>scale_colour()</code> and <code>geom_point()</code></h4>
<pre class="r"><code># Randomly generate some data
scatterdata &lt;- data.frame(x = rnorm(100, 50, 15))
scatterdata$y &lt;- with(scatterdata, runif(100, x-5, x+5))
scatterdata$xnew &lt;- round(scatterdata$x/20)*20
scatterdata$xnew &lt;- as.factor(scatterdata$xnew)
scatterdata$class &lt;- factor(round(scatterdata$x/10) %% 2, 
                            labels = c(&quot;high&quot;, &quot;low&quot;))
quants &lt;- quantile(scatterdata$x) + c(0, 0, 0, 0, .1)
qs &lt;- rowSums(sapply(quants, function(i) scatterdata$x &lt; i))
scatterdata$class4 &lt;- factor(qs, levels = 1:4, ordered = TRUE,
                             labels = c(&quot;high&quot;, &quot;medhigh&quot;, &quot;medlow&quot;, &quot;low&quot;))

s1 &lt;- ggplot() + 
  geom_point(data = scatterdata, aes(x = x, y = y)) +
  xlab(&quot;very long x axis label&quot;) + 
  ylab(&quot;very long y axis label&quot;) +
  ggtitle(&quot;Titles are awesome&quot;)

#&#39; Colours, Demonstrates axis -- works with factor data
#&#39; Specify colours using R colour names
s2 &lt;- ggplot() +
  geom_point(data = scatterdata, aes(x = xnew, y = y), colour = &quot;blue&quot;) +
  ggtitle(&quot;Colours are cool&quot;)

#&#39; Specify colours manually using hex values
s3 &lt;- ggplot() + 
  geom_point(data = scatterdata, 
             aes(x = xnew, y = y, colour = class, fill = class)) + 
  scale_colour_manual(values = c(&quot;#FF0000&quot;, &quot;#0000FF&quot;)) + 
  scale_fill_manual(values = c(&quot;#FF0000&quot;, &quot;#0000FF&quot;)) +
  ggtitle(&quot;Manual colour/fill scales&quot;)

#&#39; Categorical colour scales 
s4 &lt;- ggplot() + 
  geom_point(data = scatterdata, 
             aes(x = xnew, y = y, colour = xnew, fill = xnew)) +
  ggtitle(&quot;Categorical colour/fill scales&quot;)

#&#39; Color by x*y axis (no binning)
s6 &lt;- ggplot() + 
  geom_point(data = scatterdata, 
             aes(x = x, y = y, color = x*y, fill = x*y)) +
  ggtitle(&quot;Continuous color scales&quot;)

points_simple &lt;- list(s1 = s1, s2 = s2, s3 = s3, s4 = s4, s6 = s6)
points_simple</code></pre>
<pre><code>## $s1</code></pre>
<p><img src="index_files/figure-html/pointssimple-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre><code>## 
## $s2</code></pre>
<p><img src="index_files/figure-html/pointssimple-2.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre><code>## 
## $s3</code></pre>
<p><img src="index_files/figure-html/pointssimple-3.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre><code>## 
## $s4</code></pre>
<p><img src="index_files/figure-html/pointssimple-4.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre><code>## 
## $s6</code></pre>
<p><img src="index_files/figure-html/pointssimple-5.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(points_simple, &quot;geoms/point-simple&quot;)</code></pre>
<p><a href="geoms/point-simple">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="geom_jitter" class="section level4">
<h4><code>geom_jitter()</code></h4>
<pre class="r"><code>s5 &lt;- ggplot() + 
  geom_jitter(data = scatterdata, 
              aes(x = xnew, y = y, colour = class4, fill = class4)) +
  ggtitle(&quot;geom_jitter&quot;)
s5</code></pre>
<p><img src="index_files/figure-html/jitterplots-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(s5 = s5), &quot;geoms/jitterplots&quot;)</code></pre>
<p><a href="geoms/jitterplots">Click here</a> to see the resulting animint plot(s).</p>
</div>
</div>
<div id="interactive-plots-and-scale_size" class="section level3">
<h3>Interactive plots and <code>scale_size()</code></h3>
<p>With <code>showSelected</code>, it is sometimes useful to have two copies of a geom - one copy with low alpha that has no <code>showSelected</code> or <code>clickSelects</code> attributes, and another copy that is interactive. This allows the data to be visible all the time while still utilizing the interactivity of d3.</p>
<pre class="r"><code>library(&quot;plyr&quot;)
scatterdata2 &lt;- data.frame(x = rnorm(1000, 0, .5), 
                           y = rnorm(1000, 0, .5))
scatterdata2$quad &lt;- c(3, 4, 2, 1)[with(scatterdata2, 
                                        (3 + sign(x) + 2*sign(y))/2 + 1)]
scatterdata2$quad &lt;- factor(scatterdata2$quad, 
                            labels = c(&quot;Q1&quot;, &quot;Q2&quot;, &quot;Q3&quot;, &quot;Q4&quot;), ordered = TRUE)
scatterdata2 &lt;- ddply(scatterdata2, .(quad), 
                      transform, str = sqrt(x^2 + y^2)/4)
scatterdata2.summary &lt;- ddply(scatterdata2, .(quad), summarise, 
                              xmin = min(x), xmax = max(x), ymin = min(y), 
                              ymax = max(y), xmean = mean(x), ymean = mean(y))
qplot(data = scatterdata2, x = x, y = y, geom = &quot;point&quot;, colour = quad)</code></pre>
<p><img src="index_files/figure-html/sizepoints-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#&#39; Interactive plots...
s7 &lt;- ggplot() + 
  geom_rect(data = scatterdata2.summary, alpha = .3,
            aes(xmax = xmax, xmin = xmin, ymax = ymax, ymin = ymin, 
                colour = quad, fill = quad, clickSelects  =  quad)) +
  geom_point(data = scatterdata2.summary, size = 5,
             aes(x = xmean, y = ymean, colour = quad, 
                 fill = quad, showSelected  =  quad)) +
  geom_point(data = scatterdata2, aes(x = x, y = y), alpha = .15) + 
  scale_colour_discrete(guide = &quot;legend&quot;) + 
  scale_fill_discrete(guide = &quot;legend&quot;) +
  scale_alpha_discrete(guide = &quot;none&quot;) +
  ggtitle(&quot;Selects &amp; Means&quot;)

#&#39; Single alpha value
s8 &lt;- ggplot() + 
  geom_point(data = scatterdata2, alpha = .2,
             aes(x = x, y = y, colour = quad, fill = quad)) +
  geom_point(data = scatterdata2, alpha = .6,
             aes(x = x, y = y, colour = quad, fill = quad,
                 clickSelects = quad, showSelected = quad)) +
  guides(colour = guide_legend(override.aes = list(alpha = 1)), 
         fill = guide_legend(override.aes = list(alpha = 1))) +
  ggtitle(&quot;Constant alpha&quot;)

#&#39; Continuous alpha
s9 &lt;- ggplot() +
  geom_point(data = scatterdata2, alpha = .2,
             aes(x = x, y = y, colour = quad, fill = quad)) +
  geom_point(data = scatterdata2, 
             aes(x = x, y = y, colour = quad, fill = quad, alpha = str,
                 clickSelects = quad, showSelected = quad)) +
  guides(colour = guide_legend(override.aes = list(alpha = 1)), 
         fill = guide_legend(override.aes = list(alpha = 1))) +
  scale_alpha(range = c(.6, 1), guide = &quot;none&quot;) +
  ggtitle(&quot;Continuous alpha&quot;)

#&#39; Categorical alpha and scale_alpha_discrete()
#&#39; Note, to get unselected points to show up, need to have two copies of geom_point: One for anything that isn&#39;t selected, one for only the selected points.
s10 &lt;- ggplot() + 
  geom_point(data = scatterdata2, 
             aes(x = x, y = y, colour = quad, fill = quad, alpha = quad)) +
  geom_point(data = scatterdata2, 
             aes(x = x, y = y, colour = quad, fill = quad, 
                 alpha = quad, clickSelects = quad, showSelected = quad)) +
  guides(colour = guide_legend(override.aes = list(alpha = 1)), 
         fill = guide_legend(override.aes = list(alpha = 1))) +
  scale_alpha_discrete(guide = &quot;none&quot;) + ggtitle(&quot;Discrete alpha&quot;)

#&#39; Point Size Scaling
#&#39; Scale defaults to radius, but area is more easily interpreted by the brain (Tufte).
s11 &lt;- ggplot() + 
  geom_point(data = scatterdata2, alpha = .5,
             aes(x = x, y = y, colour = quad, 
                 fill = quad, size = str)) +
  geom_point(data = scatterdata2, alpha = .3,
             aes(x = x, y = y, colour = quad, fill = quad, 
                 size = str, clickSelects = quad, showSelected = quad)) +
  ggtitle(&quot;Scale Size&quot;)

s12 &lt;- ggplot() + 
  geom_point(data = scatterdata2, alpha = .5,
             aes(x = x, y = y, colour = quad, fill = quad, size = str)) + 
  scale_size_area() + ggtitle(&quot;Scale Area&quot;)

pts &lt;- list(s7 = s7, s8 = s8, s9 = s9, s10 = s10, s11 = s11, s12 = s12)
pts</code></pre>
<pre><code>## $s7</code></pre>
<p><img src="index_files/figure-html/sizepoints-2.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre><code>## 
## $s8</code></pre>
<p><img src="index_files/figure-html/sizepoints-3.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre><code>## 
## $s9</code></pre>
<p><img src="index_files/figure-html/sizepoints-4.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre><code>## 
## $s10</code></pre>
<p><img src="index_files/figure-html/sizepoints-5.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre><code>## 
## $s11</code></pre>
<p><img src="index_files/figure-html/sizepoints-6.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre><code>## 
## $s12</code></pre>
<p><img src="index_files/figure-html/sizepoints-7.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(pts, &quot;geoms/sizepoints&quot;)</code></pre>
<p><a href="geoms/sizepoints">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="geom_abline" class="section level3">
<h3><code>geom_abline()</code></h3>
<pre class="r"><code>xydata &lt;- data.frame(x = sort(runif(50, 0, 10)))
xydata$y &lt;- 3 + 2 * xydata$x + rnorm(50, 0, 1)
g1 &lt;- ggplot() + 
  geom_point(data = xydata, aes(x = x, y = y)) + 
  geom_abline(data = data.frame(intercept = c(3, 0), slope = c(2, 1)),
              aes(intercept = intercept, slope = slope)) +
  ggtitle(&quot;geom_abline&quot;)
g1</code></pre>
<p><img src="index_files/figure-html/abline-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g1 = g1), &quot;geoms/abline&quot;)</code></pre>
<p><a href="geoms/abline">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="geom_ribbon" class="section level3">
<h3><code>geom_ribbon()</code></h3>
<pre class="r"><code>ribbondata &lt;- data.frame(x=seq(0, 1, .1), 
                         ymin=runif(11, 0, 1), 
                         ymax=runif(11, 1, 2))
ribbondata &lt;- rbind(cbind(ribbondata, group = &quot;low&quot;), 
                    cbind(ribbondata, group = &quot;high&quot;))
ribbondata[12:22, 2:3] &lt;- ribbondata[12:22, 2:3] + 1
g2 &lt;- ggplot() + 
  geom_ribbon(data = ribbondata, alpha = .5,
              aes(x = x, ymin = ymin, ymax = ymax, 
                  group = group, fill = group)) + 
  ggtitle(&quot;geom_ribbon&quot;)
g2</code></pre>
<p><img src="index_files/figure-html/ribbon-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g2 = g2), &quot;geoms/ribbon&quot;)</code></pre>
<p><a href="geoms/ribbon">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="geom_tile" class="section level3">
<h3><code>geom_tile()</code></h3>
<pre class="r"><code>tiledata &lt;- data.frame(x = rnorm(1000, 0, 3))
tiledata$y &lt;- rnorm(1000, tiledata$x, 3)
tiledata$rx &lt;- round(tiledata$x)
tiledata$ry &lt;- round(tiledata$y)
tiledata &lt;- ddply(tiledata, .(rx,ry), summarise, n = length(rx))

g3 &lt;- ggplot() + 
  geom_tile(data = tiledata, 
            aes(x = rx, y = ry, fill = n)) +
  scale_fill_gradient(low = &quot;#56B1F7&quot;, high = &quot;#132B43&quot;) + 
  xlab(&quot;x&quot;) + ylab(&quot;y&quot;) + ggtitle(&quot;geom_tile&quot;)
g3</code></pre>
<p><img src="index_files/figure-html/tile-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g3 = g3), &quot;geoms/tile&quot;)</code></pre>
<p><a href="geoms/tile">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="geom_path" class="section level3">
<h3><code>geom_path()</code></h3>
<pre class="r"><code>pathdata &lt;- data.frame(x = rnorm(30, 0, .5), y = rnorm(30, 0, .5), z = 1:30)
g4 &lt;- ggplot() + 
  geom_path(data = pathdata, alpha = .5,
            aes(x = x, y = y)) +
  geom_text(data = pathdata, 
            aes(x = x, y = y, label = z)) + 
  ggtitle(&quot;geom_path&quot;)
g4</code></pre>
<p><img src="index_files/figure-html/path-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g4 = g4), &quot;geoms/path&quot;)</code></pre>
<p><a href="geoms/path">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="geom_polygon" class="section level3">
<h3><code>geom_polygon()</code></h3>
<pre class="r"><code>polydata &lt;- rbind(
  data.frame(x = c(0, .5, 1, .5, 0), y = c(0, 0, 1, 1, 0), 
             group = &quot;parallelogram&quot;, fill = &quot;blue&quot;, xc = .5, yc = .5),
  data.frame(x = c(.5, .75, 1, .5), y = c(.5, 0, .5, .5), 
             group = &quot;triangle&quot;, fill = &quot;red&quot;, xc = .75, yc = .33))
g5 &lt;- ggplot() + 
  geom_polygon(data = polydata, alpha = .5,
               aes(x = x, y = y, group = group, 
                   fill = fill, colour = fill)) +
  scale_colour_identity() + scale_fill_identity() +
  geom_text(data = polydata, aes(x = xc, y = yc, label = group)) +
  ggtitle(&quot;geom_polygon&quot;)
g5</code></pre>
<p><img src="index_files/figure-html/polygons-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g5 = g5), &quot;geoms/polygons&quot;)</code></pre>
<p><a href="geoms/polygons">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="geom_linerange" class="section level3">
<h3><code>geom_linerange()</code></h3>
<pre class="r"><code>boxplotdata &lt;- rbind(data.frame(x = 1:50, y = rnorm(50, 3, 1), group = &quot;N(3,1)&quot;),
                     data.frame(x = 1:50, y = rnorm(50, 0, 1), group = &quot;N(0,1)&quot;), 
                     data.frame(x = 1:50, y = rgamma(50, 2, 1/3), group = &quot;Gamma(2,1/3)&quot;))
boxplotdata &lt;- ddply(boxplotdata, .(group), transform, 
                     ymax = max(y), ymin = min(y), med = median(y))

g6 &lt;- ggplot() + 
  geom_linerange(data = boxplotdata, 
                 aes(x = factor(group), ymax = ymax, ymin = ymin, 
                     colour = factor(group))) +
  ggtitle(&quot;geom_linerange&quot;) + xlab(&quot;Distribution&quot;) +
  scale_colour_discrete(&quot;Distribution&quot;)
g6</code></pre>
<p><img src="index_files/figure-html/linerange-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g6 = g6), &quot;geoms/linerange&quot;)</code></pre>
<p><a href="geoms/linerange">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="geom_histogram" class="section level3">
<h3><code>geom_histogram()</code></h3>
<pre class="r"><code>g7 &lt;- ggplot() + 
  geom_histogram(data = subset(boxplotdata, group == &quot;Gamma(2,1/3)&quot;), 
                 aes(x = y, fill = ..count..), binwidth = 1) + 
  ggtitle(&quot;geom_histogram&quot;)
g7</code></pre>
<p><img src="index_files/figure-html/histogram-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g7 = g7), &quot;geoms/histogram&quot;)</code></pre>
<p><a href="geoms/histogram">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="geom_violin" class="section level3">
<h3><code>geom_violin()</code></h3>
<pre class="r"><code>g8 &lt;- ggplot() + 
  geom_violin(data = boxplotdata, 
              aes(x = group, y = y, fill = group, group = group)) +
  ggtitle(&quot;geom_violin&quot;) + scale_fill_discrete(&quot;Distribution&quot;) +
  xlab(&quot;Distribution&quot;)
g8</code></pre>
<p><img src="index_files/figure-html/violin-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g8 = g8), &quot;geoms/violin&quot;)</code></pre>
<p><a href="geoms/violin">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="geom_step" class="section level3">
<h3><code>geom_step()</code></h3>
<pre class="r"><code>g9 &lt;- ggplot() + 
  geom_step(data = boxplotdata, 
            aes(x = x, y = y, colour = factor(group), group = group)) +
  scale_colour_discrete(&quot;Distribution&quot;) +
  ggtitle(&quot;geom_step&quot;)
g9</code></pre>
<p><img src="index_files/figure-html/step-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g9 = g9), &quot;geoms/step&quot;)</code></pre>
<p><a href="geoms/step">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="geom_contour" class="section level3">
<h3><code>geom_contour()</code></h3>
<pre class="r"><code>library(reshape2) # for melt
contourdata &lt;- melt(volcano)
names(contourdata) &lt;- c(&quot;x&quot;, &quot;y&quot;, &quot;z&quot;)
g11 &lt;- ggplot() + 
  geom_contour(data = contourdata, 
               aes(x = x, y = y, z = z), 
               binwidth = 4, size = 0.5) + 
  geom_contour(data = contourdata, 
               aes(x = x, y = y, z = z), binwidth = 10, size = 1) +
  ggtitle(&quot;geom_contour&quot;)

contourdata2 &lt;- floor(contourdata/3) * 3 # to make fewer tiles

g12 &lt;- ggplot() + 
  geom_tile(data = contourdata2, 
            aes(x = x, y = y, fill = z, colour = z)) + 
  geom_contour(data = contourdata, 
               aes(x = x, y = y, z = z), 
               colour = &quot;black&quot;, size = .5) +
  scale_fill_continuous(&quot;height&quot;, low = &quot;#56B1F7&quot;, high = &quot;#132B43&quot;, 
                        guide = &quot;legend&quot;) +
  scale_colour_continuous(&quot;height&quot;, low = &quot;#56B1F7&quot;, high = &quot;#132B43&quot;, 
                          guide = &quot;legend&quot;) +
  ggtitle(&quot;geom_tile + geom_contour&quot;) 

contours &lt;- list(g11 = g11, g12 = g12)
contours</code></pre>
<pre><code>## $g11</code></pre>
<p><img src="index_files/figure-html/contour-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre><code>## 
## $g12</code></pre>
<p><img src="index_files/figure-html/contour-2.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(contours, &quot;geoms/contours&quot;)</code></pre>
<p><a href="geoms/contours">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="scale_y_log10-and-geom_contour-with-stat_density2d" class="section level3">
<h3><code>scale_y_log10()</code> and <code>geom_contour()</code> with <code>stat_density2d()</code></h3>
<p>While <code>stat_density2d()</code> does not always work reliably, we can still use the statistic within another geom, such as <code>geom_contour()</code>.</p>
<pre class="r"><code>library(&quot;MASS&quot;)
data(geyser, package = &quot;MASS&quot;)
g13 &lt;- ggplot() +  
  geom_point(data = geyser, 
             aes(x = duration, y = waiting)) + 
  geom_contour(data = geyser, 
               aes(x = duration, y = waiting), 
               colour = &quot;blue&quot;, size = .5, stat = &quot;density2d&quot;) + 
  xlim(0.5, 6) + scale_y_log10(limits = c(40,110)) +
  ggtitle(&quot;geom_contour 2d density&quot;)
g13</code></pre>
<p><img src="index_files/figure-html/scaleycontour-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g13 = g13), &quot;geoms/scaleycontour&quot;)</code></pre>
<p><a href="geoms/scaleycontour">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="geom_polygon-with-stat-density2d-contours" class="section level3">
<h3><code>geom_polygon</code> with <code>stat = 'density2d'</code> contours</h3>
<pre class="r"><code>g14 &lt;- ggplot() +  
  geom_polygon(data = geyser,
               aes(x = duration, y = waiting, 
                   fill = ..level.., group = ..piece..), 
               stat = &quot;density2d&quot;, alpha = .5) +
  geom_point(data = geyser, aes(x = duration, y = waiting)) + 
  scale_fill_continuous(&quot;Density Level&quot;, low = &quot;#56B1F7&quot;, high = &quot;#132B43&quot;) + 
  guides(colour = guide_legend(override.aes = list(alpha = 1)), 
         fill = guide_legend(override.aes = list(alpha = 1))) + 
  scale_y_continuous(limits = c(40,110), trans = &quot;log10&quot;) +
  scale_x_continuous(limits = c(.5, 6)) +
  ggtitle(&quot;geom_density2d polygon&quot;)
g14</code></pre>
<p><img src="index_files/figure-html/densitypolygon-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g14 = g14), &quot;geoms/densitypolygon&quot;)</code></pre>
<p><a href="geoms/densitypolygon">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="tile-plot-filled-by-density" class="section level3">
<h3>Tile plot filled by density</h3>
<pre class="r"><code>data(diamonds)
dsmall &lt;- diamonds[sample(nrow(diamonds), 1000), ] # reduce dataset size
g15 &lt;- ggplot() + 
  geom_tile(data = dsmall, stat = &quot;density2d&quot;, contour = FALSE, n = 30,
            aes(x = carat, y = price, fill = ..density.., colour = ..density..)) +
  scale_fill_gradient(limits = c(1e-5,8e-4), na.value = &quot;white&quot;) + 
  scale_colour_gradient(limits = c(1e-5,8e-4), na.value = &quot;white&quot;) +
  ggtitle(&quot;geom_density2d tile&quot;) + ylim(c(0, 19000))
g15</code></pre>
<p><img src="index_files/figure-html/tiledensity-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g15 = g15), &quot;geoms/tiledensity&quot;)</code></pre>
<p><a href="geoms/tiledensity">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="density-mapped-to-point-size" class="section level3">
<h3>Density mapped to point size</h3>
<pre class="r"><code>g16 &lt;- ggplot() + 
  geom_point(data = dsmall, aes(x = carat, y = price, alpha = ..density..), 
             stat = &quot;density2d&quot;, contour = FALSE, n = 10, size = I(1)) +
  scale_alpha_continuous(&quot;Density&quot;) +
  ggtitle(&quot;geom_density2d points&quot;)
g16</code></pre>
<p><img src="index_files/figure-html/pointdensity-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g16 = g16), &quot;geoms/pointdensity&quot;)</code></pre>
<p><a href="geoms/pointdensity">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="creating-maps-with-animint" class="section level3">
<h3>Creating maps with animint</h3>
<p>While <code>geom_map()</code> is not implemented in animint, it is possible to plot a map using <code>geom_polygon()</code> and merge. As map data frames can be rather large, it may be useful to use a point thinning algorithm, such as the <code>dp()</code> function in the <a href="http://cran.r-project.org/web/packages/shapefiles/shapefiles.pdf"><strong>shapefiles</strong></a>] to reduce the number of points in each polygon.</p>
<pre class="r"><code>library(reshape2) # for melt
library(maps)

# obtain data for US Arrests
crimes &lt;- data.frame(state = tolower(rownames(USArrests)), USArrests)
crimesm &lt;- melt(crimes, id = 1)
# data frame should contain only counts of number of assaults
crimes.sub &lt;- subset(crimesm, variable == &quot;Assault&quot;) 

# load map for mainland US
states_map &lt;- map_data(&quot;state&quot;)

# merge assault data with map data, so that each state 
# (&quot;region&quot; in the map dataframe) has a corresponding 
# entry for number of assaults.
assault.map &lt;- merge(states_map, subset(crimesm, variable == &quot;Assault&quot;),
                     by.x = &quot;region&quot;, by.y = &quot;state&quot;)
assault.map &lt;- assault.map[order(assault.map$group, assault.map$order),]

g17 &lt;- ggplot() + 
  geom_polygon(data = assault.map, 
               aes(x = long, y = lat, group = group, 
                   fill = value, colour = value)) +
  expand_limits(x = states_map$long, y = states_map$lat) + 
  ggtitle(&quot;geom_polygon map&quot;) + ylim(c(12, 63)) + 
  geom_text(data = data.frame(x = -95.84, y = 55, label = &quot;Arrests for Assault&quot;),
            hjust = .5, aes(x = x, y = y, label = label))
g17  </code></pre>
<p><img src="index_files/figure-html/maptutorial-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g17 = g17), &quot;geoms/maptutorial&quot;)</code></pre>
<p><a href="geoms/maptutorial">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="stacked-bar-chart" class="section level3">
<h3>Stacked bar chart</h3>
<p>While <code>geom_bar()</code> does not work well with <code>clickSelects</code>, it does work when creating a static plot. If you need to use <code>clickSelects</code> to select a specific bar, you should use <code>make_bar()</code>, <code>stat_summary()</code>, or calculate the relevant dataframe. This ensures that <code>clickSelects</code> does not conflict with the specification of individual plot elements in <strong>ggplot2</strong>. See the <a href="tornado-example">tornadoes example</a> for more information and examples of <code>clickSelects</code> with <code>geom_bar()</code>.</p>
<pre class="r"><code>g18 &lt;- ggplot() + 
  geom_bar(data = mtcars, 
           aes(x = factor(cyl), fill = factor(vs))) + 
  ggtitle(&quot;geom_bar stacked&quot;)
g18</code></pre>
<p><img src="index_files/figure-html/stackedbar-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g18 = g18), &quot;geoms/stackedbar&quot;)</code></pre>
<p><a href="geoms/stackedbar">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="geom_area-with-stat_density" class="section level3">
<h3><code>geom_area()</code> with <code>stat_density()</code></h3>
<pre class="r"><code>data(diamonds)
g19 &lt;- ggplot() + 
  geom_area(data=diamonds, aes(x=clarity, y=..count.., group=cut, colour=cut, fill=cut), stat=&quot;density&quot;) +
  ggtitle(&quot;geom_area&quot;)

g19</code></pre>
<p><img src="index_files/figure-html/areadensity-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g19 = g19), &quot;geoms/areadensity&quot;)</code></pre>
<p><a href="geoms/areadensity">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="geom_freqpoly" class="section level3">
<h3><code>geom_freqpoly()</code></h3>
<pre class="r"><code>g20 &lt;- ggplot() + 
  geom_freqpoly(data = diamonds, 
                aes(x = clarity, group = cut, colour = cut)) +
  ggtitle(&quot;geom_freqpoly&quot;)
g20</code></pre>
<p><img src="index_files/figure-html/freqpoly-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g20 = g20), &quot;geoms/freqpoly&quot;)</code></pre>
<p><a href="geoms/freqpoly">Click here</a> to see the resulting animint plot(s).</p>
</div>
<div id="geom_hex" class="section level3">
<h3><code>geom_hex()</code></h3>
<pre class="r"><code>g21 &lt;- ggplot() + 
  geom_hex(data = dsmall, aes(x = carat, y = price)) +
  scale_fill_gradient(low = &quot;#56B1F7&quot;, high = &quot;#132B43&quot;) + 
  xlab(&quot;x&quot;) + ylab(&quot;y&quot;) + ggtitle(&quot;geom_hex&quot;)
g21</code></pre>
<p><img src="index_files/figure-html/hex-1.png" title="" alt="" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>animint2dir(list(g21 = g21), &quot;geoms/hex&quot;)</code></pre>
<p><a href="geoms/hex">Click here</a> to see the resulting animint plot(s).</p>
</div>
</div>
<div id="session-info" class="section level2">
<h2>Session Info</h2>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 3.1.3 (2015-03-09)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 8 x64 (build 9200)
## 
## locale:
## [1] LC_COLLATE=English_United States.1252 
## [2] LC_CTYPE=English_United States.1252   
## [3] LC_MONETARY=English_United States.1252
## [4] LC_NUMERIC=C                          
## [5] LC_TIME=English_United States.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] hexbin_1.27.0      MASS_7.3-39        reshape2_1.4.1    
## [4] lubridate_1.3.3    maps_2.3-9         plyr_1.8.1        
## [7] animint_2015.06.16 proto_0.3-10       ggplot2_1.0.0.99  
## 
## loaded via a namespace (and not attached):
##  [1] colorspace_1.2-4 digest_0.6.8     evaluate_0.5.5   formatR_1.0     
##  [5] grid_3.1.3       gtable_0.1.2     htmltools_0.2.6  knitr_1.9       
##  [9] labeling_0.3     lattice_0.20-30  memoise_0.2.1    munsell_0.4.2   
## [13] Rcpp_0.11.5      RJSONIO_1.3-0    rmarkdown_0.5.1  scales_0.2.4    
## [17] stringr_0.6.2    tools_3.1.3      yaml_2.1.13</code></pre>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
